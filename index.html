<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"
    />
    <title>Big</title>
    <link href="big.css" rel="stylesheet" type="text/css" />
    <link href="dark.css" rel="stylesheet" type="text/css" />
    <link href="custom.css" rel="stylesheet" type="text/css" />
    <link
      rel="stylesheet"
      href="//unpkg.com/@highlightjs/cdn-assets@11.6.0/styles/default.min.css"
    />
    <script src="//unpkg.com/@highlightjs/cdn-assets@11.6.0/highlight.min.js"></script>
    <script src="big.js"></script>
    <script>
      hljs.highlightAll();
    </script>
    <style>
      .hljs {
        overflow-x: initial;
      }
    </style>
  </head>
  <body class="dark">
    <!-- slide 1   -->
    <div class="layout" style="grid-template-rows: 75% 25%">
      <div>
        Just another COG in the machine: all about Cloud Optimized Geotiffs
      </div>
      <div class="subtitle">Kris Johnson, NRRI - GIS/LIS 2023</div>
      <notes>Speakers notes go here.</notes>
    </div>

    <!-- slide 2 -->
    <div>
      <div>
        Link to presentation slides
        <a href="https://tinyurl.com/geo-tiff">https://tinyurl.com/geo-tiff</a>
      </div>
    </div>

    <!-- Outline -->
    <div>
      <div>
        Cloud Optimized GeoTIFF (COGs):
        <ul>
          <li>What are they?</li>
          <li>How can I make one for my kids?</li>
          <li>How (and why) would I use one?</li>
          <li>Examples</li>
          <li>My use case</li>
        </ul>
      </div>
      <notes>Speakers notes go here.</notes>
    </div>

    <!-- slide 4 -->
    <div style="background-color: white">
      <img src="https://www.cogeo.org/images/logo/Cog-02.png" />
      <notes>Who's heard of COGs? Used them?</notes>
    </div>

    <!-- What are they? -->

    <!-- slide 5 -->
    <div>
      <div>
        A
        <a target="_blank" href="https://www.cogeo.org/"
          >Cloud Optmized GeoTIFF</a
        >
        is <em>a regular GeoTIFF file</em>, hosted on a
        <em>HTTP file server</em>, with an <em>internal organization</em> that
        allows clients issuing ‚ÄãHTTP <em>GET range requests</em> to ask for just
        the parts of a file they need.
      </div>
      <notes>Speakers notes go here.</notes>
    </div>

    <!-- slide 9 -->
    <div>
      <div>Let's break that definition down</div>
      <notes>Speakers notes go here.</notes>
    </div>

    <!-- slide 9 -->
    <div>
      <div>
        <i>A regular GeoTIFF</i>
      </div>
      <notes>Speakers notes go here.</notes>
    </div>

    <!-- slide 9 -->
    <div>
      <div>
        <blockquote>
          <p>
            GeoTIFF is a public domain metadata standard that enables
            georeferencing information to be embedded within an image (TIFF)
            file.
          </p>
        </blockquote>
        Essentially, a common <em>raster</em> data format
      </div>
      <notes>Speakers notes go here.</notes>
    </div>

    <!-- slide 9 -->
    <div>
      <div class="small">A <i>regular</i> GeoTIFF</div>
      <div>
        <blockquote><p>...with an internal organization...</p></blockquote>
      </div>
      <notes>Speakers notes go here.</notes>
    </div>

    <!-- slide 9 -->
    <div>
      <div>
        Translation: <em>Tiling</em> and <em>Overviews</em><br />
        <span class="small">and <em>compression</em></span>
      </div>
      <notes>Speakers notes go here.</notes>
    </div>

    <!-- slide 10 -->
    <div class="layout" style="grid-template-rows: 25% 75%">
      <div>Internal Tiling</div>
      <img src="./images/internal-tiling.png" />
      <notes>Speakers notes go here.</notes>
    </div>

    <!-- slide 10 -->
    <div>
      Tiles
      <ul>
        <li>Each tile is its own TIFF image</li>
        <li>With its own metadata and header</li>
        <li>Usually 256x256, but can be any size</li>
      </ul>
      <notes>Speakers notes go here.</notes>
    </div>

    <!-- slide 10 -->
    <div class="layout" style="grid-template-rows: 15% 85%">
      <div>Overviews</div>
      <img src="./images/overviews.png" />
      <notes>Speakers notes go here.</notes>
    </div>

    <!-- slide 10 -->
    <div>
      <div class="subtitle">Overviews</div>
      <div>
        Allow for smaller, lower resolution versions to be used in place of the
        original
      </div>
      <notes>Speakers notes go here.</notes>
    </div>

    <!-- slide 10 -->
    <div>
      Compression: <br />
      just allows for even faster streaming to clients
      <notes>Speakers notes go here.</notes>
    </div>

    <!-- slide 10 -->
    <div>
      <div>
        A web server <span class="small">capable of HTTP range requests</span>
      </div>
      <notes>Speakers notes go here.</notes>
    </div>

    <!-- slide 10 -->
    <div class="layout" style="grid-template-rows: 25% 75%">
      <div>object storage in the ‚òÅÔ∏è</div>
      <div>
        <img
          src="https://pbs.twimg.com/profile_images/1605297940242669568/q8-vPggS_400x400.jpg"
        />
        <img
          src="https://miro.medium.com/v2/resize:fit:1400/1*b_al7C5p26tbZG4sy-CWqw.png"
        />
      </div>
      <notes>Speakers notes go here.</notes>
    </div>

    <!-- slide 10 -->
    <div class="layout" style="grid-template-rows: 50% 50%">
      <div>files on a traditional web server</div>
      <div>
        <img
          src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRTSsTxOWnIURmTYeYZlY4uX15DZHu60kGjw6GxwoWtR1pHezts2F8lyweYsn_f3MHIDSQ&usqp=CAU"
        />
        <img
          src="https://encrypted-tbn1.gstatic.com/images?q=tbn:ANd9GcRWayd3GthNwzUYFenCgkBNpX3voSV11ziwzXwCiXn7YeLsGniI"
        />
      </div>
      <notes>Speakers notes go here.</notes>
    </div>

    <!-- slide 10 -->
    <div>
      <div>
        <span class="small">A web server</span> capable of HTTP range requests
      </div>
      <notes>Speakers notes go here.</notes>
    </div>

    <!-- slide 10 -->
    <div>
      Look for
      <pre>Accept-Ranges: bytes</pre>
      in the response header
      <notes>Speakers notes go here.</notes>
    </div>

    <!-- slide 10 -->
    <div class="layout" style="grid-template-rows: 25% 75%">
      <div>Range requests (AKA&nbsp;<i>byte serving</i>)</div>
      <img
        style="background-color: white"
        src="https://bunnyacademy.b-cdn.net/What-Are-HTTP-Range-Requests.png"
      />
      <notes>Speakers notes go here.</notes>
    </div>

    <!-- slide 10 -->
    <div>
      <div class="small">Pulling it all together:</div>
      <div>
        Allows clients to request only the relevant portions of the image, and
        not the whole file üòÖ
      </div>
      <notes>Speakers notes go here.</notes>
    </div>

    <!-- How can I make one for my kids? -->

    <!-- slide 10 -->
    <div>
      How can I make one?
      <notes>Speakers notes go here.</notes>
    </div>

    <!-- slide 10 -->
    <div>
      <em>GDAL</em>
      <div class="small">what else?</div>
      <notes>Speakers notes go here.</notes>
    </div>

    <!-- slide 10 -->
    <div>
      <div class="subtitle">since version 3.1</div>
      <pre>gdalwarp <em>-of COG</em> intput.tif outputCOG.tif</pre>
      <pre>
gdal_translate world.tif world_webmerc_cog.tif <em>-of COG</em> <br>-co TILING_SCHEME=GoogleMapsCompatible -co COMPRESS=JPEG</pre>
      <a href="https://gdal.org/drivers/raster/cog.html"
        >https://gdal.org/drivers/raster/cog.html</a
      >
      <notes>Speakers notes go here.</notes>
    </div>

    <!-- slide 10 -->
    <div>
      <div>Pythonüêç: rio-cogeo</div>
      <pre>rio cogeo create input.tif outputCOG.tif</pre>
      <a href="https://cogeotiff.github.io/rio-cogeo/"
        >https://cogeotiff.github.io/rio-cogeo/</a
      >
      <notes>Speakers notes go here.</notes>
    </div>

    <!-- slide 10 -->
    <div>
      Then, load it onto a web server and you're ready to üö¢
      <notes>Speakers notes go here.</notes>
    </div>

    <!-- slide 10 -->
    <div>
      How do you use them?
      <notes>Speakers notes go here.</notes>
    </div>

    <!-- slide 10 -->
    <div>
      Anywhere you can use a regular GeoTIFF, actually
      <notes>Speakers notes go here.</notes>
    </div>

    <!-- slide 10 -->
    <div>
      <ul>
        <li>Desktop GIS</li>
        <li>Web Maps</li>
        <li>Data Sharing and Distribution</li>
      </ul>
      <notes>Speakers notes go here.</notes>
    </div>

    <!-- Why Use -->
    <!-- slide 12 -->
    <div>
      Why use a ‚öôÔ∏è?
      <notes></notes>
    </div>

    <!-- slide 12 -->
    <div>
      <ul>
        <li>Improved performance / Reduced cost</li>
        <li>Scalability</li>
        <li>Accessibility / Interoperability</li>
        <li>Reduced data duplication</li>
      </ul>
      <notes></notes>
    </div>

    <!-- slide 12 -->
    <div>
      Improved performance / Reduced cost
      <ul>
        <li>efficient access</li>
        <li>reduced bandwidth consumption</li>
      </ul>
      <notes>internal tiling and overviews</notes>
    </div>

    <!-- slide 12 -->
    <div>
      <span class="top-title">Scalability</span> <br />
      <br />
      Efficient streaming enables integration with cloud-based workflows
      <ul>
        <li><a href="https://geotrellis.io/">Geotrellis</a></li>
        <li><a href="https://developers.maxar.com/">Maxar</a></li>
        <li>
          <a href="https://earthengine.google.com/">Google Earth Engine</a>
        </li>
        <li><a href="https://www.planet.com/explorer">Planet Explorer</a></li>
      </ul>
      <notes></notes>
    </div>

    <!-- slide 13 -->
    <div>
      <div>
        Server-side (the traditional approach)
        <ul>
          <li>WMS (for rendering)</li>
          <li>WCS (for analyzing)</li>
        </ul>
      </div>
      <notes>Site license; I'll talk about later</notes>
    </div>
    <!-- slide 14 -->
    <div>
      Client-side (raster rendering and analysis in your browser)
      <ul>
        <li>parse multiple formats (remote, local, via ArrayBuffer)</li>
        <li>compression</li>
        <li>resampling</li>
        <li>bounding box</li>
      </ul>
      <notes>Speakers notes go here.</notes>
    </div>
    <!-- slide 15 -->
    <div>
      <div>Essentially, the raster equivalent of GeoJSON ü§Ø</div>
      <notes>Speakers notes go here.</notes>
    </div>

    <!-- slide 15 -->
    <div>
      <div class="subtitle">-- OR --</div>
      <div><em>server-less</em> raster analysis üí•</div>
      <notes>Speakers notes go here.</notes>
    </div>
    <!-- slide 16 -->
    <div>
      <div>Complimentary Technologies</div>

      <div class="subtitle" style="font-style: italic">
        I'm not an expert so I need to rely on these
      </div>
      <notes>Speakers notes go here.</notes>
    </div>
    <!-- slide 17 -->
    <div>
      <a target="_blank" href="https://github.com/GeoTIFF/georaster"
        >Georaster</a
      >
      - simplifies the JavaScript interface to geotiff.js
      <notes>Speakers notes go here.</notes>
    </div>
    <!-- slide 18 -->
    <div>
      <a
        target="_blank"
        href="https://github.com/GeoTIFF/georaster-layer-for-leaflet"
        >Georaster Layer for Leaflet</a
      >
      - Leaflet plugin for georasters
      <notes>Speakers notes go here.</notes>
    </div>

    <!-- slide 18 -->
    <div>
      <div>How to use it?</div>
      <div class="subtitle">
        ref:
        <a
          target="_blank"
          href="https://github.com/GeoTIFF/georaster-layer-for-leaflet#usage-example"
          >https://github.com/GeoTIFF/georaster-layer-for-leaflet#usage-example</a
        >
      </div>
      <notes>Speakers notes go here.</notes>
    </div>

    <!-- slide 20 -->
    <div>
      <div>load GeoTIFF</div>
      <pre><code class="language-javascript">      fetch(url_to_geotiff_file)
        .then((response) => {
            response.arrayBuffer())</code></pre>
      <notes>Speakers notes go here.</notes>
    </div>

    <!-- slide 20 -->
    <div>
      <div>parse ArrayBuffer to Georaster</div>
      <pre><code class="language-javascript">     .then((arrayBuffer) => {
        parseGeoraster(arrayBuffer)
        .then((georaster) => {</code></pre>
      <notes
        >The ArrayBuffer object is used to represent a generic, fixed-length raw
        binary data buffer. It is an array of bytes, often referred to in other
        languages as a "byte array". You cannot directly manipulate the contents
        of an ArrayBuffer; instead, you create one of the typed array objects or
        a DataView object which represents the buffer in a specific format, and
        use that to read and write the contents of the buffer.</notes
      >
    </div>

    <!-- slide 20 -->
    <div>
      <div>create Leaflet layer from Georaster</div>
      <pre><code class="language-javascript">var layer = new GeoRasterLayer({
        georaster: georaster,
        opacity: 0.7,
      });
      layer.addTo(map);{</code></pre>
      <notes>This extends L.gridLayer so all the same options apply</notes>
    </div>

    <!-- slide 20 -->
    <div>
      Examples
      <notes>Speakers notes go here.</notes>
    </div>
    <!-- slide 21 -->
    <div>
      <div>
        <a target="_blank" href="https://landsatlook.usgs.gov/explore"
          >LandsatLook</a
        >
        - a tool that allows rapid online viewing and access to the USGS Landsat
        Collection 2 data
      </div>
      <notes
        >LandsatLook is a tool that allows rapid online viewing and access to
        the USGS Landsat Collection 2 data. LandsatLook leverages resources
        available via a commercial cloud environment including Cloud Optimized
        GeoTIFF (COG) and Spatio Temporal Asset Catalog (STAC) metadata.
      </notes>
    </div>

    <!-- slide 22 -->
    <div>
      <div>
        <a target="_blank" href="https://app.geotiff.io/">GeoTIFF.io</a> - add
        your own GeoTIFF and play around
      </div>
      <notes>add your own GeoTIFF and play around</notes>
    </div>

    <!-- slide 21 -->
    <div>
      <div>
        <a target="_blank" href="examples\basic.html">Basic example</a> - load
        GeoTIFF from file
      </div>
      <notes>add your own GeoTIFF and play around</notes>
    </div>

    <!-- slide 21 -->
    <div>
      <div class="top-title">
        <a
          target="_blank"
          href="https://geotiff.github.io/georaster-layer-for-leaflet-example/examples/color-scale.html"
          >Color scale example</a
        >
      </div>
      <pre><code>
        pixelValuesToColorFn: function(pixelValues) {
            var pixelValue = pixelValues[0]; // there's just one band in this raster

            if (pixelValue === 0) return null;

            // scale to 0 - 1 used by chroma
            var scaledPixelValue = (pixelValue - min) / range;

            var color = scale(scaledPixelValue).hex();

            return color;
          },
      </code></pre>
      <notes></notes>
    </div>

    <!-- slide 21 -->
    <div>
      <div class="top-title">
        <a
          target="_blank"
          href="https://geotiff.github.io/georaster-layer-for-leaflet-example/examples/ycbcr.html"
          >YCbCr Photometric Interpretation example</a
        >
      </div>
      <pre><code>
        pixelValuesToColorFn: values => {
            const r = Math.round(values[0] + 1.40200 * (values[2] - 0x80));
            const g = Math.round(values[0] - 0.34414 * (values[1] - 0x80) - 0.71414 * (values[2] - 0x80));
            const b = Math.round(values[0] + 1.77200 * (values[1] - 0x80));
            return `rgb(${r},${g},${b})`;
          }
      </code></pre>
      <notes></notes>
    </div>

    <!-- slide 21 -->
    <div>
      <div class="top-title">
        <a
          target="_blank"
          href="https://geotiff.github.io/georaster-layer-for-leaflet-example/examples/wind-direction-arrows.html"
          >Custom draw function (wind arrows)</a
        >
      </div>
      <pre><code>
        customDrawFunction: function({ context, x, y, width, height, values }) {
            var value = values[0];
            var arrowSize = width / 2.5;
            context.save();
            context.translate(x, y);
            context.rotate((90+value)*Math.PI/180);
            context.beginPath();
            context.moveTo(-arrowSize/2, 0);
            context.lineTo(+arrowSize/2, 0);
            context.moveTo(arrowSize*0.25, -arrowSize*0.25);
            context.lineTo(+arrowSize/2, 0);
            context.lineTo(arrowSize*0.25, arrowSize*0.25);
            context.stroke();
            context.restore();
          }
      </code></pre>
      <notes></notes>
    </div>

    <!-- slide 21 -->
    <div>
      <div class="top-title">
        <a
          target="_blank"
          href="https://geotiff.github.io/georaster-layer-for-leaflet-example/examples/load-cog-via-script-tag.html"
          >Re-projection</a
        >
      </div>
      <div>GeoTIFF is using EPSG:32615 (WGS 84 / UTM zone 15N)</div>
      <notes></notes>
    </div>

    <!-- slide 21 -->
    <div>
      <div>
        <a
          target="_blank"
          href="https://geotiff.github.io/georaster-layer-for-leaflet-example/examples/load-cog-via-script-tag.html"
          >COG example</a
        >
        - load Cloud Optimized GeoTIFF
      </div>
      <notes>add your own GeoTIFF and play around</notes>
    </div>

    <!-- slide 21 -->
    <div>
      <div>Request headers<img src="images/range.png" /></div>
      <br />
      <div>Response headers<img src="images/content-range.png" /></div>
      <notes>add your own GeoTIFF and play around</notes>
    </div>

    <!-- slide 21 -->
    <div>
      <div>
        Cuts that didn't make into this presentation:

        <a
          target="_blank"
          href="https://observablehq.com/@geosurge/geoblaze-cloud-optimized-raster-analysis"
          >raster analysis</a
        >
        using <a href="https://geoblaze.io/">GeoBlaze</a>
      </div>
      <notes>add your own GeoTIFF and play around</notes>
    </div>

    <!-- slide 21 -->
    <div class="layout" style="grid-template-rows: 15% 125%">
      <div>
        My use case:&nbsp;
        <a target="_blank" href="https://bit.ly/3RSSeGh">mnforcast.org</a>
      </div>
      <img src="images/forcast.png" />
      <notes></notes>
    </div>

    <!-- slide 21 -->
    <div>
      <div>
        Use this approach when:
        <ul>
          <li>You don't have access to a server</li>
          <li>You don't want to mess with a server</li>
          <li>
            You want to speed up imagery/raster load times (by using
            <em>COG</em>s)
          </li>
          <li>You want client-side imagery/raster analysis</li>
        </ul>
      </div>
      <notes>Summary</notes>
    </div>

    <div>
      <ul>
        image/content/resources:
        <li>
          <a
            href="https://developers.planet.com/docs/planetschool/an-introduction-to-cloud-optimized-geotiffs-cogs-part-1-overview/"
            >https://developers.planet.com/docs/planetschool/an-introduction-to-cloud-optimized-geotiffs-cogs-part-1-overview/</a
          >
        </li>
        <li>
          More ways to generate COGs:
          <a href="https://www.cogeo.org/#implementations"
            >https://www.cogeo.org/#implementations</a
          >
        </li>
        <li></li>
        <li></li>
        <li></li>
      </ul>
    </div>

    <!-- last slide -->
    <div>
      <div>Thank you!</div>
      <div class="subtitle nowrap">Kris Johnson, NRRI/UMD</div>
      <div class="subtitle">kristofj@d.umn.edu</div>
    </div>
  </body>
</html>
